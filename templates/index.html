<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="preconnect" href="https://fonts.googleapis.com/" crossorigin="anonymous" />
		<link rel="preconnect" href="https://unpkg.com/" crossorigin="anonymous" />
		<link
			rel="preload"
			as="style"
			onload="this.onload=null;this.rel='stylesheet'"
			href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400;1,500;1,600&display=swap"
		/>
		<link
			rel="preload"
			as="style"
			onload="this.onload=null;this.rel='stylesheet'"
			href="https://unpkg.com/@fortawesome/fontawesome-free@^6/css/all.min.css"
		/>
		<link
			rel="preload"
			as="style"
			onload="this.onload=null;this.rel='stylesheet'"
			href="https://unpkg.com/@open-xamu-co/ui-styles@^3.0.0-next.29/dist/index.min.css"
		/>
		<title>Home - Findeter cybersecurity challenge</title>
		<style>
			::selection {
				background: #0f47af;
				color: #fff;
			}
			#appex {
				width: 100%;
				height: 100%;
				overflow: hidden;
			}
		</style>
	</head>
	<body>
		<main id="appex" class="--txtColor-dark7">
			<div id="login" class="view --flx --minHeight-100">
				<section class="view-item --minHeightVh-100 --bgColor">
					<div class="holder --flx-center --gap-30">
						<div class="flx --flxColumn --flx-center-start --gap-30 --flx --pY">
							<div class="flx --flxColumn --gap-5">
								<h4 class="--opacity-05">Findeter cybersecurity challenge</h4>
								<h1>Login</h1>
							</div>
							<form
								id="login"
								action="#"
								method="post"
								class="holder --width-480 --maxWidth-100 --minWidth-100 --p-none flx --flxColumn --flx-start-stretch --gap-30"
							>
								<div class="flx --flxColumn --flx-start-stretch">
									<h4 class="--txtColor">Fill your data:</h4>
									<div class="flx --flxColumn --flx-start-stretch --gap-5">
										<p class="--txtSize-sm">User name*</p>
										<div class="iTxt">
											<input
												id="username"
												name="username"
												type="text"
												placeholder="Your user name..."
												title="User name"
												autocomplete="off"
												required
											/>
											<i aria-hidden="true" class="fa-at fas icon"></i>
										</div>
									</div>
									<div class="flx --flxColumn --flx-start-stretch --gap-5">
										<p class="--txtSize-sm">Password*</p>
										<div class="iTxt">
											<input
												id="password"
												name="password"
												type="password"
												placeholder="Your password..."
												title="Password"
												autocomplete="off"
												required
											/>
											<i aria-hidden="true" class="fa-lock fas icon"></i>
										</div>
									</div>
									<div
										class="flx --flxRow-wrap --flx-center --flx-start-center:md --gap"
									>
										<button class="bttn" type="submit">Log in</button>
									</div>
								</div>
							</form>
						</div>
						<div class="txt --pY --txtSize-sm">
							<p>
								Develop by
								<b>Daniel Castillo</b>
								&
								<b>Victor Saa.</b>
							</p>
						</div>
					</div>
				</section>
			</div>
		</main>
		<script type="text/javascript">
			const loginForm = document.getElementById("login");

			loginForm.addEventListener("submit", async (event) => {
				event.preventDefault();

				const username = document.getElementById("username").value;
				const password = document.getElementById("password").value;

				if (!username || !password) return alert("Username and password are required");

				try {
					const response = await fetch("/login", {
						method: "POST",
						headers: { "Content-Type": "application/json" },
						body: JSON.stringify({ username, password }),
					});
					const result = await response.json();

					if (result.data) {
						alert("Login successful");
						location = "/admin";

						return;
					}

					alert("Invalid username or password");
				} catch (err) {
					console.error("Error:", err);
					alert(err);
				}
			});
		</script>
	</body>
</html>
